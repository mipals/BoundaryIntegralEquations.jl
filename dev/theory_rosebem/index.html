<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ROSEBEM Theory · BoundaryIntegralEquations.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BoundaryIntegralEquations.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../theory_background/">Background Theory</a></li><li class="is-active"><a class="tocitem" href>ROSEBEM Theory</a><ul class="internal"><li><a class="tocitem" href="#The-ROSEBEM"><span>The ROSEBEM</span></a></li><li><a class="tocitem" href="#Visualization"><span>Visualization</span></a></li><li><a class="tocitem" href="#Bibliography"><span>Bibliography</span></a></li></ul></li><li><a class="tocitem" href="../theory_lossy/">Viscothermal Losses Theory</a></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">3D</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/3d_rosebem/">ROSEBEM: Rigid sphere scattering</a></li><li><a class="tocitem" href="../examples/3d_rigid_sphere/">Rigid sphere scattering (Exterior)</a></li><li><a class="tocitem" href="../examples/3d_oscilating_sphere/">Oscilating sphere (Interior)</a></li><li><a class="tocitem" href="../examples/3d_pulsating_sphere/">Pulsating sphere (Interior)</a></li><li><a class="tocitem" href="../examples/3d_cube_wave/">Cube with vibrating sides (Interior)</a></li><li><a class="tocitem" href="../examples/3d_cube_wave_anechoic/">Cube with anechoic condition (Interior)</a></li><li><a class="tocitem" href="../examples/3d_lossy_sphere/">Oscilating Lossy sphere (Exterior)</a></li><li><a class="tocitem" href="../examples/3d_element_usage/">Surface Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">2D</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/2d_infinite_cylinder/">Scattering of infinite cylinder</a></li><li><a class="tocitem" href="../examples/2d_element_usage/">Curve Functions</a></li></ul></li></ul></li><li><span class="tocitem">Internals</span><ul><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">3D</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../3d_kernels/">Kernels</a></li><li><a class="tocitem" href="../3d_elements/">Element Types</a></li><li><a class="tocitem" href="../3d_meshes/">Meshes</a></li><li><a class="tocitem" href="../3d_fast_operators/">Fast Operators</a></li><li><a class="tocitem" href="../3d_losses/">Viscous and Thermal Losses</a></li><li><a class="tocitem" href="../3d_rosebem/">ROSEBEM</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">2D</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../2d_kernels/">Kernels</a></li><li><a class="tocitem" href="../2d_elements/">Element Types</a></li><li><a class="tocitem" href="../2d_meshes/">Meshes</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>ROSEBEM Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ROSEBEM Theory</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mipals/BoundaryIntegralEquations.jl/blob/main/docs/src/theory_rosebem.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Reduced-Order-Series-Expansion-Boundary-Element-Method-(ROSEBEM)"><a class="docs-heading-anchor" href="#Reduced-Order-Series-Expansion-Boundary-Element-Method-(ROSEBEM)">Reduced Order Series Expansion Boundary Element Method (ROSEBEM)</a><a id="Reduced-Order-Series-Expansion-Boundary-Element-Method-(ROSEBEM)-1"></a><a class="docs-heading-anchor-permalink" href="#Reduced-Order-Series-Expansion-Boundary-Element-Method-(ROSEBEM)" title="Permalink"></a></h1><p>This page includes the (some of) theoretical foundations speeding up multifrequency problems using the Reduced Order Series Expansion Boundary Element Method (ROSEBEM) <a href="../theory_background/#panagiotopoulos2020">[6]</a> <a href="../theory_background/#Paltorp2023">[7]</a>.</p><p>For an example <a href="../examples/3d_rosebem/">look here.</a></p><h2 id="The-ROSEBEM"><a class="docs-heading-anchor" href="#The-ROSEBEM">The ROSEBEM</a><a id="The-ROSEBEM-1"></a><a class="docs-heading-anchor-permalink" href="#The-ROSEBEM" title="Permalink"></a></h2><p>In <a href="../theory_background/#panagiotopoulos2020">[6]</a> the boundary integrals is made frequency independent by utilizing a Taylor expansion of w.r.t the wavenumber for the Green&#39;s function and its normal derivative</p><p class="math-container">\[\begin{equation*}
    G(\mathbf{x},\mathbf{y}) \approx \sum_{m=0}^{N_v - 1} \frac{(k - k_0)^m}{m!}\left[G^{(m)}(\mathbf{x},\mathbf{y},k_0)\right],\quad \frac{\partial G(\mathbf{x},\mathbf{y})}{\partial\mathbf{n}(\mathbf{y})} \approx \sum_{m=0}^{N_p-1} \frac{(k - k_0)^m}{m!}\left[\mathbf{n}(\mathbf{y})^\top\nabla G^{(m)}(\mathbf{x},\mathbf{y},k_0)\right],
\end{equation*}\]</p><p>where <span>$N_v$</span> and <span>$N_p$</span> is the number of terms included in the Taylor expansion of respectively the Green&#39;s function and its normal derivative while <span>$k_0$</span> is the expansion wavenumber. For simplification purposes, it is in the following chosen to set <span>$N_p=N_v=M$</span>. Inserting the above into the Kirchhoff-Helmholtz integral equation the following system of equations will appear</p><p class="math-container">\[\begin{equation}
    \left(\text{diag}(\mathbf{\zeta}) + \sum_{m=0}^{M-1}\frac{(k - k_0)^m}{m!}\mathbf{F}_m(k_0)\right)\mathbf{p} \approx    
    \mathrm{i} \rho_0 c k\left(\sum_{m=0}^{M-1}\frac{(k - k_0)^m}{m!}\mathbf{G}_m(k_0) \right)\mathbf{v}_n,
\end{equation}\]</p><p>which it sometimes referred to as the series expansion boundary element method or SEBEM for short. The important aspect of above equation is that the two series of matrices, <span>$\mathbf{F}_m$</span> and <span>$\mathbf{G}_m$</span>, depend only on the expansion wavenumber <span>$k_0$</span> and can therefore be computed in a so-called offline stage. After applying boundary conditions the system will have the form of </p><p class="math-container">\[\begin{equation}
    \left(\sum_{m=0}^{M-1}\frac{(k - k_0)^m}{m!}\mathbf{A}_m(k_0)\right)\mathbf{z} \approx \sum_{m=0}^{M-1}\frac{(k - k_0)^m}{m!}\mathbf{b}_m(k_0),
\end{equation}\]</p><p>where <span>$\mathbf{z}$</span> is a vector containing nodal values of either <span>$\mathbf{p}$</span> or <span>$\mathbf{v}_n$</span>. Unfortunately, the equation above does not resolve all the issues, as it only reduces the assembly from a discretization of boundary integrals to a sum of matrices that still scales as <span>$O(n^2)$</span> in both computation and storage. Additionally, for large systems, the time spent solving the linear system of equations is overshadowed by the time spent assembling the linear system, making the gain of using the equation above insignificant with respect to the total computational time. </p><p>In order to reduce both the memory footprint and the assembly time of SEBEM a Galerkin projection can be applied. The main assumption behind this projection is that the solution, as well as the right-hand side of SEBEM is spanned by a lower dimensional subspace. This means that</p><p class="math-container">\[\begin{equation}
    \mathbf{z} \approx \mathbf{U}_\ell\mathbf{z}_\ell, \quad \mathbf{b}_m \approx \mathbf{U}_\ell \mathbf{b}_{\ell m}, \quad \ \mathbf{U}_\ell, \in \mathbb{C}^{N\times\ell}
\end{equation}\]</p><p>will be good approximations. For simplification purposes, it is often chosen to let <span>$\mathbf{U}_\ell$</span> be unitary. An intuitive explanation as to why this must be a good approximation is that most BE systems are well-conditioned and iterative solvers such as the generalized minimal residual method (GMRes) converge quickly. In addition, this motivates a good place to search for both <span>$\mathbf{U}_\ell$</span> is the <span>$\ell$</span>-Krylov subspace defined by <a href="../theory_background/#hdgm15">[8]</a></p><p class="math-container">\[\begin{equation}
    \mathcal{K}_\ell\left(\mathbf{A}(k), \mathbf{b}(k)\right) = \text{span}\left\{\mathbf{b}(k),\ \mathbf{A}(k)\mathbf{b}(k),\ \mathbf{A}(k)^2\mathbf{b}(k),\ \dots,\ \mathbf{A}(k)^{\ell-1}\mathbf{b}(k) \right\}.
\end{equation}\]</p><p>Setting the columns of <span>$\mathbf{U}_\ell$</span> equal to the Krylov vectors would result in the lower dimensional subspace approximation being a good approximation for wavenumbers close to <span>$k$</span>. The subspace can be made to handle a wider range of wavenumbers by combining the Krylov subspace for the wavenumbers <span>$k_1,k_2,\dots k_L$</span>. As such the final projection matrix, <span>$\mathbf{U}_\ell$</span>, is computed as the singular value decomposition (SVD) of the concatenation of the columns of all the <span>$q$</span>-Krylov vector subspaces </p><p class="math-container">\[\begin{equation}
    \mathbf{U}_\ell\Sigma_\ell \mathbf{V}_\ell^{\mathsf{H}} = \text{svd}\left( \begin{bmatrix}\mathbf{K}_{k_1}&amp; \mathbf{K}_{k_2}&amp; \dots &amp; \mathbf{K}_{k_L}\end{bmatrix} \right),
\end{equation}\]</p><p>where <span>$\mathbf{K}_{k_i}$</span> denotes a matrix with columns equal to some Krylov vectors at wavenumber <span>$k_i$</span>. Now inserting the lower dimensional subspace approximatiion into SEBEM equation while also multiplying both sides with the hermitian transpose of <span>$\mathbf{U}_\ell$</span> from the left it follows that</p><p class="math-container">\[\begin{equation}
    \left(\sum_{m=0}^{M-1}\frac{(k - k_0)^m}{m!}\mathbf{U}_\ell^\mathsf{H}\mathbf{A}_m(k_0)\mathbf{U}_\ell\right)\mathbf{z}_\ell \approx \sum_{m=0}^{M-1}\frac{(k - k_0)^m}{m!}\mathbf{U}_\ell^\mathsf{H}\mathbf{U}_\ell\mathbf{b}_{\ell m}(k_0).
\end{equation}\]</p><p>Using that <span>$\mathbf{U}_\ell$</span> is unitary while defining <span>$\mathbf{A}_{\ell m} = \mathbf{U}_\ell^\mathsf{H}\mathbf{A}_m(k_0)\mathbf{U}_\ell$</span> the above becomes</p><p class="math-container">\[\begin{equation}
    \left(\sum_{m=0}^{M-1}\frac{(k - k_0)^m}{m!}\mathbf{A}_{\ell m}(k_0)\right)\mathbf{z}_\ell \approx \sum_{m=0}^{M-1}\frac{(k - k_0)^m}{m!}\mathbf{b}_{\ell m}(k_0).
\end{equation}\]</p><p>The important part of the above is that <span>$\mathbf{A}_{\ell m}(k_0) \in \mathbb{C}^{\ell\times\ell}$</span> and <span>$\mathbf{b}_{\ell m}(k_0)\in\mathbb{C}^\ell$</span>, which means that if <span>$\ell \ll n$</span> this representation requires significantly less memory than the original system. Note, however, that <span>$\mathbf{A}_m(k_0)$</span> should never explicitly be stored. Instead, the rows should be projected during the assembly phase.</p><h2 id="Visualization"><a class="docs-heading-anchor" href="#Visualization">Visualization</a><a id="Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization" title="Permalink"></a></h2><p>In many cases visualizations of the mathematics gives rise to a deeper understanding. Therefore, a short visual introduction to the ROSEBEM incorporating the BLI boundary condition is given. We start by introducing the following visual representation of the vector spaces <img src="../figures/rosebem_1.png" alt="Step1"/> Using this we can visualize the SEBEM as <img src="../figures/rosebem_2.png" alt="Step2"/> Similarly, the reduced basis assumption, for both <span>$\mathbf{p}$</span> and <span>$\partial_\mathbf{n}\mathbf{p}$</span>, is visualized as <img src="../figures/rosebem_3.png" alt="Step3"/> Inserting assumption from above into the SEBEM visualization <img src="../figures/rosebem_4.png" alt="Step4"/> Finally by performing the matrix-matrix, the ROSEBEM appears as <img src="../figures/rosebem_5.png" alt="Step5"/></p><h2 id="Bibliography"><a class="docs-heading-anchor" href="#Bibliography">Bibliography</a><a id="Bibliography-1"></a><a class="docs-heading-anchor-permalink" href="#Bibliography" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[6]</dt>
<dd>
<div id="panagiotopoulos2020">D. Panagiotopoulos, E. Deckers and W. Desmet. <i>Krylov subspaces recycling based model order reduction for acoustic BEM systems and an error estimator</i>. <a href='https://doi.org/https://doi.org/10.1016/j.cma.2019.112755'>Computer Methods in Applied Mechanics and Engineering <b>359</b>, 112755 (2020)</a>.</div>
</dd><dt>[7]</dt>
<dd>
<div id="Paltorp2023">M. Paltorp, V. C. Henríquez, N. Aage and P. R. Andersen. <i>A Reduced Order Series Expansion for the BEM Incorporating the Boundary Layer Impedance Condition</i>. <a href='https://doi.org/10.1142/s2591728523500123'>Journal of Theoretical and Computational Acoustics (2023)</a>.</div>
</dd><dt>[8]</dt>
<dd>
<div id="hdgm15">N. J. Higham, M. R. Dennis, P. Glendinning, P. A. Martin, F. Santosa and J. Tanner. <i>The Princeton Companion to Applied Mathematics</i>. <a href='https://doi.org/https://doi.org/10.1515/9781400874477'>Princeton University Press, Princeton, NJ, USA (2015)</a>.</div>
</dd>
</dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory_background/">« Background Theory</a><a class="docs-footer-nextpage" href="../theory_lossy/">Viscothermal Losses Theory »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 5 September 2023 13:54">Tuesday 5 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
